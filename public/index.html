<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="screen-orientation" content="landscape">
    <title>ฺุงูุด ูุฏุง - ุงุฏุงุฑู ฺฉู ุฑูุงู ู ุฏุฑูุงู</title>

    <!-- Bale Mini App SDK -->
    <script src="https://tapi.bale.ai/miniapp.js?3"></script>

    <!-- Fonts -->
    <style>
        @font-face {
            font-family: 'IranSans';
            src: url('fonts/iran_sans.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'IranSans';
            src: url('fonts/iran_sans_bold.ttf') format('truetype');
            font-weight: bold;
            font-style: normal;
            font-display: swap;
        }

        * {
            font-family: 'IranSans', Tahoma, Arial, sans-serif !important;
        }
    </style>

    <!-- Styles -->
    <link rel="stylesheet" href="/css/style.css?v=20251220">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
        <!-- Yalda Background -->
        <div class="yalda-background">
            <!-- Snowfall Container -->
            <div class="snowfall"></div>

            <!-- Decorative Shapes -->
            <div class="decorative-shapes">
                <div class="shape shape-1"></div>
                <div class="shape shape-2"></div>
                <div class="shape shape-3"></div>
            </div>
            <!-- Floating Yalda Fruits -->
            <div class="floating-fruits">
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
            </div>
        </div>

        <!-- Login Container -->
        <div class="login-container">
            <!-- Animated Logo -->
            <div class="logo-container">
                <div class="logo-glow-outer"></div>
                <div class="logo-wrapper">
                    <div class="logo-glow"></div>
                    <img src="assets/logo-bmi.png" alt="ููฺฏู ุจุงูฺฉ ูู" class="logo-img">
                </div>
                <div class="loading-ring"></div>
                <!-- Rotating Rings -->
                <div class="logo-rotating-ring ring-1"></div>
                <div class="logo-rotating-ring ring-2"></div>
            </div>

            <!-- Title -->
            <div class="login-header">
                <h1 class="login-title">๐ฎ ฺุงูุด ูุฏุง</h1>
                <p class="login-subtitle">ุดุจ ูุฏุง ุฎุฌุณุชู ูุจุงุฑฺฉ</p>
                <div class="tagline-box">
                    <span class="tagline-text">ุงุฏุงุฑู ฺฉู ุฑูุงู ู ุฏุฑูุงู</span>
                </div>
            </div>

            <!-- Login Form -->
            <div class="login-form-wrapper">
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <div class="input-icon">๐ค</div>
                        <input type="text" id="first-name" required placeholder="ูุงู" class="form-input">
                    </div>

                    <div class="form-group">
                        <div class="input-icon">๐ค</div>
                        <input type="text" id="last-name" required placeholder="ูุงู ุฎุงููุงุฏฺฏ" class="form-input">
                    </div>

                    <div class="form-group">
                        <div class="input-icon">๐ข</div>
                        <input type="text" id="employee-code" required placeholder="ฺฉุฏ ุงุณุชุฎุฏุงู" class="form-input">
                    </div>

                    <button type="submit" class="btn-login">
                        <span class="btn-text">ูุฑูุฏ ุจู ุจุงุฒ</span>
                        <span class="btn-icon">๐ฏ</span>
                    </button>
                </form>

                <div id="error-message" class="error-message"></div>
            </div>

            <!-- Footer -->
            <div class="login-footer">
                <p class="footer-text">โจ ุดุงุฏุงุจ ู ุณูุงูุช ุฏุฑ ุณุงู ุฑูุงู โจ</p>
            </div>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen hidden">
        <!-- Game Screen Yalda Background -->
        <div class="game-yalda-bg">
            <div class="snowfall game-snow"></div>
            <div class="floating-fruits game-fruits">
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
                <span class="yalda-fruit">๐</span>
            </div>
        </div>
        
        <div class="game-hud">
            <span id="player-name" class="player-name"></span>
            <span id="game-timer" class="timer">03:00</span>
            <span id="player-score" class="score">ุงูุชุงุฒ: 0</span>
            <button id="show-leaderboard" class="btn-leaderboard">๐</button>
        </div>

        <div class="game-container">
            <canvas id="game-canvas"></canvas>
        </div>

        <div class="game-controls">
            <div class="control-row">
                <button class="control-btn" data-key="38">โ</button>
            </div>
            <div class="control-row">
                <button class="control-btn" data-key="37">โ</button>
                <button class="control-btn" data-key="40">โ</button>
                <button class="control-btn" data-key="39">โ</button>
            </div>
        </div>
    </div>

    <!-- Leaderboard Modal -->
    <div id="leaderboard-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>๐ ุจุฑุชุฑู ุจุงุฒฺฉูุงู</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div id="leaderboard-list"></div>
        </div>
    </div>

    <!-- Start Game Overlay -->
    <div id="start-overlay" class="game-overlay hidden">
        <div class="overlay-content">
            <h1 class="game-title">๐ ฺุงูุด ูุฏุง</h1>
            <p class="game-subtitle">ุงุฏุงุฑู ฺฉู ุฑูุงู ู ุฏุฑูุงู</p>
            <button id="start-game-btn" class="btn-primary" disabled>ูุทูุงู ููุงูู ุฑุง ุจุฎูุงูุฏ... (5)</button>
            <div class="game-rules">
                <h3>โ๏ธ ููุงูู ุจุงุฒ ุฑุง ุจุฎูุงูุฏ:</h3>
                <p>๐ ููุฏูุงูู: 1 ุงูุชุงุฒ</p>
                <p>๐ ุงูฺฏูุฑ: 5 ุงูุชุงุฒ</p>
                <p>๐ ุณุจ: 10 ุงูุชุงุฒ</p>
                <p>โฑ๏ธ ุฒูุงู ูุฑ ุจุงุฒ: 3 ุฏููู</p>
                <p>๐ฎ ุชุนุฏุงุฏ ุจุงุฒ: 3 ุจุงุฑ</p>
                <p>๐ ูุงุฑ ุงุฒ ุฏูุงุฑ ุฑุฏ ูโุดูุฏ!</p>
                <p>๐ ุจุฑุฎูุฑุฏ ุจุง ุจุฏู ุฎูุฏ ุง ุฏฺฏุฑุงู = ูุฑฺฏ</p>
                <p>๐ ฺฉุดุชู ุจุงุฒฺฉูุงู = ุงูุชุงุฒ ุขููุง ุจู ุดูุง ุงุถุงูู ูุดูุฏ!</p>
            </div>
            <div class="game-instructions">
                <p>๐ก ุฑุงูููุง:</p>
                <p>ุฑู ููุจุงู: ุงูฺฏุดุช ุฎูุฏ ุฑุง ุจฺฉุดุฏ</p>
                <p>ุฑู ฺฉุงููพูุชุฑ: ฺฉูุฏูุง ุฌูุชโุฏุงุฑ</p>
            </div>
        </div>
    </div>

    <!-- Game Over Overlay -->
    <div id="gameover-overlay" class="game-overlay hidden">
        <div class="overlay-content">
            <h1 class="gameover-title">ุจุงุฒ ุชูุงู ุดุฏ!</h1>
            <div class="final-stats">
                <p>ุงูุชุงุฒ ููุง: <span id="final-score">0</span></p>
                <p>ุฒูุงู ุจุงุฒ: <span id="game-time">0</span> ุซุงูู</p>
            </div>
            <p class="score-saved">โ ุงูุชุงุฒ ุดูุง ุซุจุช ุดุฏ</p>
            <button id="play-again-btn" class="btn-primary">ุจุงุฒ ูุฌุฏุฏ</button>
        </div>
    </div>

    <!-- Loading -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ...</p>
    </div>

    <!-- Scripts -->
    <!-- PixiJS v8 -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.5.2/dist/pixi.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@pixi/particle-emitter@5.0.8/dist/pixi-particles.min.js"></script>

    <script src="/socket.io/socket.io.js"></script>

    <!-- Game rendering modules (load before game.js) -->
    <script src="/js/asset-generator.js?v=20251220"></script>
    <script src="/js/particle-effects.js?v=20251220"></script>
    <script src="/js/pixi-renderer.js?v=20251220"></script>
    <script src="/js/game.js?v=20251220"></script>

    <!-- Snowfall Script -->
    <script>
        // Create snowflakes for any snowfall container
        function createSnowflakes(container) {
            if (!container) return;

            const snowflakeCount = 50;

            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.innerHTML = 'โ';
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDuration = (Math.random() * 3 + 2) + 's';
                snowflake.style.animationDelay = Math.random() * 5 + 's';
                snowflake.style.fontSize = (Math.random() * 10 + 10) + 'px';
                snowflake.style.opacity = Math.random() * 0.6 + 0.4;
                container.appendChild(snowflake);
            }
        }

        // Initialize all snowfall containers when page loads
        function initAllSnowfall() {
            document.querySelectorAll('.snowfall').forEach(createSnowflakes);
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAllSnowfall);
        } else {
            initAllSnowfall();
        }
    </script>
</body>
</html>
